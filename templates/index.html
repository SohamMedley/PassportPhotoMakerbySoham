{% extends 'base.html' %}

{% block title %}PassportPro - Create Perfect Passport Photos{% endblock %}

{% block content %}
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1>Create Perfect Passport Photos in Seconds</h1>
            <p>Professional passport photos with automatic background removal and customization options</p>
            <div class="hero-buttons">
                <a href="#upload-section" class="btn btn-primary">Create Photo Now</a>
                <a href="/about" class="btn btn-outline">Learn More</a>
            </div>
        </div>
        <div class="hero-image">
            <img src="{{ url_for('static', filename='img/hero-image.png') }}" alt="Passport Photo Example">
        </div>
    </div>
</section>

<section id="upload-section" class="upload-section">
    <div class="container">
        <div class="section-header">
            <h2>Upload Your Photo</h2>
            <p>We'll automatically remove the background and help you create the perfect passport photo</p>
        </div>
        
        <div class="upload-container">
            <form id="upload-form" action="/process" method="post" enctype="multipart/form-data">
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <p>Drag & drop your photo here or</p>
                    <label for="photo-upload" class="btn btn-secondary">Browse Files</label>
                    <input type="file" id="photo-upload" name="photo" accept="image/*" hidden>
                    <p class="upload-info">Supported formats: JPG, PNG (Max size: 10MB)</p>
                </div>
                <div class="upload-preview" id="upload-preview" style="display: none;">
                    <img id="preview-image" src="#" alt="Preview">
                    <div class="preview-actions">
                        <button type="button" id="change-photo" class="btn btn-outline">Change Photo</button>
                        <button type="submit" id="continue-btn" class="btn btn-primary">Continue <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<section class="features-section">
    <div class="container">
        <div class="section-header">
            <h2>Why Choose PassportPro?</h2>
            <p>Our advanced technology makes creating passport photos simple and fast</p>
        </div>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-magic"></i>
                </div>
                <h3>Automatic Background Removal</h3>
                <p>Our AI instantly removes any background and replaces it with the perfect color</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-palette"></i>
                </div>
                <h3>Multiple Background Options</h3>
                <p>Choose from a variety of background colors that meet passport requirements</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3>Fast Processing</h3>
                <p>Get your passport photo ready in seconds, not minutes</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-download"></i>
                </div>
                <h3>Instant Download</h3>
                <p>Download your passport photo immediately after processing</p>
            </div>
        </div>
    </div>
</section>

<section class="testimonials-section">
    <div class="container">
        <div class="section-header">
            <h2>What Our Users Say</h2>
            <p>Join thousands of satisfied customers who've used PassportPro</p>
        </div>
        
        <div class="testimonials-slider">
            <div class="testimonial">
                <div class="testimonial-content">
                    <p>"I needed a passport photo urgently and PassportPro saved me! The background removal was perfect and I got my photo in seconds."</p>
                </div>
                <div class="testimonial-author">
                    <img src="{{ url_for('static', filename='img/testimonial-1.jpg') }}" alt="Testimonial Author">
                    <div class="author-info">
                        <h4>Priya Sharma</h4>
                        <p>Delhi, India</p>
                    </div>
                </div>
            </div>
            
            <div class="testimonial">
                <div class="testimonial-content">
                    <p>"The quality of the passport photo was excellent. I was able to choose the perfect background color and download it right away."</p>
                </div>
                <div class="testimonial-author">
                    <img src="{{ url_for('static', filename='img/testimonial-2.jpg') }}" alt="Testimonial Author">
                    <div class="author-info">
                        <h4>Rahul Patel</h4>
                        <p>Mumbai, India</p>
                    </div>
                </div>
            </div>
            
            <div class="testimonial">
                <div class="testimonial-content">
                    <p>"I've tried many passport photo services, but PassportPro is by far the best. The interface is intuitive and the results are professional."</p>
                </div>
                <div class="testimonial-author">
                    <img src="{{ url_for('static', filename='img/testimonial-3.jpg') }}" alt="Testimonial Author">
                    <div class="author-info">
                        <h4>Ananya Gupta</h4>
                        <p>Bangalore, India</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const uploadForm = document.getElementById('upload-form');
        const photoUpload = document.getElementById('photo-upload');
        const uploadArea = document.getElementById('upload-area');
        const uploadPreview = document.getElementById('upload-preview');
        const previewImage = document.getElementById('preview-image');
        const changePhotoBtn = document.getElementById('change-photo');
        
        // Handle file selection
        photoUpload.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const file = this.files[0];
                
                // Check file size (max 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    alert('File size exceeds 10MB. Please choose a smaller file.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    uploadArea.style.display = 'none';
                    uploadPreview.style.display = 'block';
                    
                    // Add animation to the preview image
                    previewImage.style.opacity = '0';
                    previewImage.style.transform = 'scale(0.9)';
                    
                    setTimeout(() => {
                        previewImage.style.transition = 'all 0.5s ease';
                        previewImage.style.opacity = '1';
                        previewImage.style.transform = 'scale(1)';
                    }, 50);
                }
                
                reader.readAsDataURL(file);
            }
        });
        
        // Handle drag and drop
        uploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
            
            // Add pulsing animation
            this.style.animation = 'pulse 1.5s infinite';
        });
        
        uploadArea.addEventListener('dragleave', function() {
            this.classList.remove('dragover');
            this.style.animation = '';
        });
        
        uploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            this.style.animation = '';
            
            if (e.dataTransfer.files && e.dataTransfer.files[0]) {
                photoUpload.files = e.dataTransfer.files;
                
                const file = e.dataTransfer.files[0];
                
                // Check file size (max 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    alert('File size exceeds 10MB. Please choose a smaller file.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    uploadArea.style.display = 'none';
                    uploadPreview.style.display = 'block';
                    
                    // Add animation to the preview image
                    previewImage.style.opacity = '0';
                    previewImage.style.transform = 'scale(0.9)';
                    
                    setTimeout(() => {
                        previewImage.style.transition = 'all 0.5s ease';
                        previewImage.style.opacity = '1';
                        previewImage.style.transform = 'scale(1)';
                    }, 50);
                }
                
                reader.readAsDataURL(file);
            }
        });
        
        // Change photo button
        changePhotoBtn.addEventListener('click', function() {
            uploadArea.style.display = 'flex';
            uploadPreview.style.display = 'none';
            photoUpload.value = '';
        });
        
        // Form submission with enhanced loading animation
        uploadForm.addEventListener('submit', function(e) {
            if (!photoUpload.files || !photoUpload.files[0]) {
                e.preventDefault();
                alert('Please select a photo first.');
                return;
            }
            
            // Create and append custom loading overlay
            const loadingOverlay = document.createElement('div');
            loadingOverlay.className = 'custom-loading-overlay';
            
            const spinner = document.createElement('div');
            spinner.className = 'custom-spinner';
            
            const loadingText = document.createElement('div');
            loadingText.className = 'loading-text';
            loadingText.innerHTML = 'Processing your photo<span class="dot-animation">...</span>';
            
            loadingOverlay.appendChild(spinner);
            loadingOverlay.appendChild(loadingText);
            document.body.appendChild(loadingOverlay);
            
            // Animate dots
            let dots = 0;
            const dotAnimation = setInterval(() => {
                dots = (dots + 1) % 4;
                const dotText = '.'.repeat(dots);
                loadingText.innerHTML = `Processing your photo<span class="dot-animation">${dotText}</span>`;
            }, 300);
            
            // Allow form to submit naturally after 2 seconds
            setTimeout(function() {
                clearInterval(dotAnimation);
                // The form will submit naturally
            }, 2000);
        });
    });
</script>
{% endblock %}

